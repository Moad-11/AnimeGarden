// ===================================================================
// ==   NEW SCRIPT FOR news-detail.html - REPLACE THE SCRIPT TAG  ==
// ===================================================================
document.addEventListener('DOMContentLoaded', function() {
    const newsContainer = document.getElementById('news-detail-container');
    const savedNews = localStorage.getItem('currentNews');
    
    // دالة لتنسيق التاريخ
    function formatDate(dateString) {
        try {
            const date = new Date(dateString);
            return date.toLocaleDateString('ar-EG', { year: 'numeric', month: 'long', day: 'numeric' });
        } catch (error) {
            return "تاريخ غير متوفر";
        }
    }

    if (savedNews) {
        const newsItem = JSON.parse(savedNews);
        
        // بناء محتوى الصفحة بشكل ديناميكي
        newsContainer.innerHTML = `
            <div class="news-detail">
                <h1>${newsItem.title}</h1>
                <div class="news-meta">
                    <span><i class="fas fa-calendar"></i> ${formatDate(newsItem.date)}</span>
                    <span><i class="fas fa-newspaper"></i> ${newsItem.source}</span>
                    <span><i class="fas fa-tag"></i> ${newsItem.category}</span>
                </div>
                
                <img src="${newsItem.image}" alt="${newsItem.title}" onerror="this.src='https://images.unsplash.com/photo-1541562232579-512a21360020?w=800&h=400&fit=crop'">
                
                <div class="news-content">
                    <p>${newsItem.summary}</p>
                    <p>هذا مجرد ملخص للخبر. للحصول على التفاصيل الكاملة، يرجى زيارة المصدر الأصلي للخبر.</p>
                </div>
                
                <div class="news-tags">
                    ${newsItem.tags.map(tag => `<span>${tag}</span>`).join('')}
                </div>
            </div>
        `;
        
        // تحديث عنوان الصفحة
        document.title = newsItem.title + ' - أنمي جاردن';
    } else {
        newsContainer.innerHTML = `
            <div class="error-message" style="background: white; color: #333; padding: 2rem; border-radius: 16px; text-align: center;">
                <div class="error-icon" style="font-size: 3rem; color: var(--accent-color); margin-bottom: 1rem;">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <p>لم يتم العثور على الخبر المطلوب</p>
                <button onclick="window.close()" class="retry-btn" style="margin-top: 1rem;">
                    <i class="fas fa-arrow-right"></i>
                    العودة للرئيسية
                </button>
            </div>
        `;
    }
});
